{% extends "layout.html" %}
{% block title %}Observation Map{% endblock %}
{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='js/leaflet/leaflet.css') }}" />
<link rel="stylesheet" href="{{ url_for('static', filename='css/map.css') }}" />
{% endblock %}

{% block header %}
{% endblock %}

{% block content %}

<div id="map"></div>

<script src="{{ url_for('static', filename='js/leaflet/leaflet.js') }}"></script>
<script src="{{ url_for('static', filename='js/map.js') }}"></script>
<script>
    window.onload = async () => {
        setMapViewToUserLocation()

        let events = await getEventLocations()
        if (events.meta.total_results > 0)
            addEventMarkers(events.records)

        let palmObservations = await getObservations('palm')
        if (palmObservations.meta.total_results > 0)
            addObservationMarkers(palmObservations.records, 'palm')

        let cycadObservations = await getObservations('cycad')
        if (cycadObservations.meta.total_results > 0)
            addObservationMarkers(cycadObservations.records, 'cycad')
    }
</script>

{% endblock %}